machine:
  python:
    version: 3.6.0
  post:
    - pyenv global 3.6.0 3.5.1 3.4.4
dependencies:
  override:
    - pip install -r dev-requirements.txt
  post:
    - sudo apt-get install libzmq-dev
    - python3 -m pip install --upgrade ipykernel
    - python3 -m ipykernel install --user
    - wget https://github.com/jgm/pandoc/releases/download/1.19/pandoc-1.19-1-amd64.deb
    - sudo dpkg -i pandoc-1.19-1-amd64.deb
test:
  pre:
    - python mmworkbench/nparse.py:
        background: true
    - while ! nc -z localhost 2626; do sleep 5; done;:
        timeout: 150
  post:
    - make docs
deployment:
  s3:
    branch: /(develop)|(staging)|(master)/
    commands:
      - bash docs/scripts/upload_to_s3.sh
