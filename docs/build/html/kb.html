

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building The Knowledge Base &mdash; Workbench 1.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Workbench 1.0.0 documentation" href="index.html"/>
        <link rel="next" title="Defining The Entity Map" href="entity_map.html"/>
        <link rel="prev" title="Training Data" href="training_data.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Workbench
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Learn</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="anatomy.html">Anatomy of a Deep-Domain Conversational AI System</a></li>
</ul>
<p class="caption"><span class="caption-text">Build</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="training_data.html">Training Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building The Knowledge Base</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#knowledge-base-configuration">Knowledge Base Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#knowledge-base-schema">Knowledge Base Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-the-knowledge-base">Create The Knowledge Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-options">Advanced Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="entity_map.html">Defining The Entity Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_classification.html">Building the Domain Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="intent_classification.html">Building the Intent Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="entity_recognition.html">Building the Entity Recognizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="role_classification.html">Building The Role Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="entity_resolution.html">Building the Entity Resolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="semantic_parsing.html">Building the Semantic Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialogue_manager.html">Building the Dialogue Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="question_answering.html">Building the Question Answerer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlg.html">Building the NLG</a></li>
</ul>
<p class="caption"><span class="caption-text">Deploy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deploying Conversational Apps</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Workbench</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Building The Knowledge Base</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/kb.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="building-the-knowledge-base">
<h1>Building The Knowledge Base<a class="headerlink" href="#building-the-knowledge-base" title="Permalink to this headline">¶</a></h1>
<p>In order to build Deep-Domain Question Answering systems for large content catalogs, a Knowledge Base is required. For narrow-vocabulary domains, it is likely possible to create short lists which capture every possible entity value. But for medium- and large-vocabulary domains, a Knowledge Base can be helpful for storing and exporting all the potential entity values (names of artists, actors, titles, products, etc).</p>
<p>A Knowledge Base (KB) can be in the form of a simple Key-Value store, a relational database, or graph database.  In Workbench, we support both a lightweight relational database (Sqlite) with a fast full-text index (FTS-5) and a more full-featured Elasticsearch database.</p>
<div class="section" id="knowledge-base-configuration">
<h2>Knowledge Base Configuration<a class="headerlink" href="#knowledge-base-configuration" title="Permalink to this headline">¶</a></h2>
<p>Each domain defines its own configuration for knowledge base.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;knowledgebase-type&quot;</span><span class="o">:</span> <span class="s2">&quot;elasticsearch&quot;</span><span class="p">,</span>
  <span class="s2">&quot;elasticsearch-host&quot;</span><span class="o">:</span> <span class="s2">&quot;search.prod&quot;</span><span class="p">,</span>
  <span class="s2">&quot;elasticsearch-build-host&quot;</span><span class="o">:</span> <span class="s2">&quot;search-prod.mindmeld.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;elasticsearch-port&quot;</span><span class="o">:</span> <span class="mi">9200</span><span class="p">,</span>
  <span class="s2">&quot;elasticsearch-index-name&quot;</span><span class="o">:</span> <span class="s2">&quot;my-app-index&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the KB type is &#8220;elasticsearch&#8221;, the following parameters need to be defined.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>knowledgebase-type</td>
<td>Valid values are “sqlite” and “elasticsearch”</td>
</tr>
<tr class="row-odd"><td>elasticsearch-host</td>
<td>ES cluster host name (used for AWS hosted env)</td>
</tr>
<tr class="row-even"><td>elasticsearch-build-host</td>
<td>ES cluster host name</td>
</tr>
<tr class="row-odd"><td>elasticsearch-port</td>
<td>ES cluster port</td>
</tr>
<tr class="row-even"><td>elasticsearch-index-name</td>
<td>name of ES index</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="knowledge-base-schema">
<h2>Knowledge Base Schema<a class="headerlink" href="#knowledge-base-schema" title="Permalink to this headline">¶</a></h2>
<p>As part of building any database, a schema needs to be defined. This can be defined in the <strong>&#8220;schema.json&#8221;</strong> file for the Music-Assistant example as follows.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;object-type&quot;</span><span class="o">:</span> <span class="s2">&quot;music&quot;</span><span class="p">,</span>
  <span class="s2">&quot;popularity-field&quot;</span><span class="o">:</span> <span class="s2">&quot;reviewcount&quot;</span><span class="p">,</span>
  <span class="s2">&quot;type-field&quot;</span><span class="o">:</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span>
  <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;old-name&quot;</span><span class="o">:</span> <span class="s2">&quot;oldid&quot;</span><span class="p">,</span>
      <span class="s2">&quot;new-name&quot;</span><span class="o">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;ID&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;old-name&quot;</span><span class="o">:</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span>
      <span class="s2">&quot;new-name&quot;</span><span class="o">:</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;detect-entities&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;old-name&quot;</span><span class="o">:</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span>
      <span class="s2">&quot;new-name&quot;</span><span class="o">:</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;TEXT&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;old-name&quot;</span><span class="o">:</span> <span class="s2">&quot;genres&quot;</span><span class="p">,</span>
      <span class="s2">&quot;new-name&quot;</span><span class="o">:</span> <span class="s2">&quot;genres&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;LIST&quot;</span><span class="p">,</span>
      <span class="s2">&quot;detect-entities&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;old-name&quot;</span><span class="o">:</span> <span class="s2">&quot;number-of-reviews&quot;</span><span class="p">,</span>
      <span class="s2">&quot;new-name&quot;</span><span class="o">:</span> <span class="s2">&quot;reviewcount&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;INTEGER&quot;</span><span class="p">,</span>
      <span class="s2">&quot;do-not-index&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>object-type</td>
<td>the name for the table of documents.</td>
</tr>
<tr class="row-odd"><td>popularity-field</td>
<td>the name of the field (of type INTEGER or REAL) which should be used for the default popularity ranking</td>
</tr>
<tr class="row-even"><td>type-field</td>
<td>the name of the field which defines the object type (if any)</td>
</tr>
<tr class="row-odd"><td>old-name</td>
<td>the name of the field in the json file to be imported</td>
</tr>
<tr class="row-even"><td>new-name</td>
<td>the name of the field in the knowledge base</td>
</tr>
<tr class="row-odd"><td>type</td>
<td>the data type for this field (ID, TEXT, LIST, INTEGER, REAL, DATE, JSON)</td>
</tr>
<tr class="row-even"><td>detect-entities</td>
<td>a flag which indicates if this field should be used for extracting entity data files</td>
</tr>
<tr class="row-odd"><td>do-not-index</td>
<td>a flag to indicate if this field should be stored in the full-text index</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="create-the-knowledge-base">
<h2>Create The Knowledge Base<a class="headerlink" href="#create-the-knowledge-base" title="Permalink to this headline">¶</a></h2>
<p>Once the above dependencies are fulfilled, we are ready to import the data into the Knowledge Base.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindmeld.knowledge_base</span> <span class="kn">import</span> <span class="n">KnowledgeBase</span>

<span class="c1"># Initialize the KB</span>
<span class="n">kb</span> <span class="o">=</span> <span class="n">KnowledgeBase</span><span class="p">(</span><span class="s1">&#39;/path/to/kb_config&#39;</span><span class="p">)</span>

<span class="c1"># Read the data - can be read from flat files, cloud storage, or data-stream API</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">()</span>

<span class="c1"># Import Data to KB</span>
<span class="n">kb</span><span class="o">.</span><span class="n">import_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Running <strong>import_data</strong> will setup a new Elasticsearch index with the latest imported data.</p>
</div>
<div class="section" id="advanced-options">
<h2>Advanced Options<a class="headerlink" href="#advanced-options" title="Permalink to this headline">¶</a></h2>
<p>Elasticsearch (ES) is a versatile search engine based on Lucene. It provides a distributed, multitenant-capable full-text search engine with an HTTP web interface and schema-free JSON documents. The full set of documentation on tuning and adapting Elasticsearch to your needs is available <a class="reference external" href="https://www.elastic.co/">here</a>.</p>
<p>Specifically, you might need to tweak the <strong>&#8220;es_mapping.json&#8221;</strong> file in your domain. The <strong>es_mapping</strong> file defines how a document, and the fields it contains, are stored and indexed. This mapping definition is used to create an ES index. ES is flexible on text analysis and indexing. It can be configured to -</p>
<ul class="simple">
<li>Support defining text analysis behavior per field</li>
<li>Support defining sub-fields to process and index text differently for the same field.</li>
</ul>
<p>An <strong>Analyzer</strong> can be defined for each document field to specify the desirable behavior for tokenizing and filtering the field values. A built-in default analyzer available in ES. Custom analyzers can be defined based on available tokenizers and filters. It is also possible to customize tokenizer and filter in ES. More details available in the Elasticsearch documentation.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="entity_map.html" class="btn btn-neutral float-right" title="Defining The Entity Map" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="training_data.html" class="btn btn-neutral" title="Training Data" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, MindMeld Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>